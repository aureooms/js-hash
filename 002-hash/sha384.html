<!DOCTYPE html><html lang="en"><head><title>002-hash/sha384</title></head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0"><meta name="groc-relative-root" content="../"><meta name="groc-document-path" content="002-hash/sha384"><meta name="groc-project-path" content="js/src/002-hash/sha384.js"><meta name="groc-github-url" content="https://github.com/aureooms/js-hash"><link rel="stylesheet" type="text/css" media="all" href="../assets/style.css"><script type="text/javascript" src="../assets/behavior.js"></script><body><div id="meta"><div class="file-path"><a href="https://github.com/aureooms/js-hash/blob/master/js/src/002-hash/sha384.js">js/src/002-hash/sha384.js</a></div></div><div id="document"><div class="segment"></div><div class="segment"><div class="comments "><div class="wrapper"><p>SHA-384</p></div></div><div class="code"><div class="wrapper"><span class="hljs-keyword">var</span> sha384 = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(bytes, n, digest)</span> {</span>
	<span class="hljs-keyword">var</span> q, z, u, last, h, m, y, o, i, j, tail, zeroes, g, k;</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>Note 1: All variables are unsigned 64 bits and wrap modulo 2^64 when calculating
Note 2: All constants in this pseudo code are in big endian</p></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>Initialize variables
(first 64 bits of the fractional parts of the square roots of the 9th through 16th primes 23..53)</p></div></div><div class="code"><div class="wrapper">	h = [
		[<span class="hljs-number">0xcbbb9d5d</span>, <span class="hljs-number">0xc1059ed8</span>],
		[<span class="hljs-number">0x629a292a</span>, <span class="hljs-number">0x367cd507</span>],
		[<span class="hljs-number">0x9159015a</span>, <span class="hljs-number">0x3070dd17</span>],
		[<span class="hljs-number">0x152fecd8</span>, <span class="hljs-number">0xf70e5939</span>],
		[<span class="hljs-number">0x67332667</span>, <span class="hljs-number">0xffc00b31</span>],
		[<span class="hljs-number">0x8eb44a87</span>, <span class="hljs-number">0x68581511</span>],
		[<span class="hljs-number">0xdb0c2e0d</span>, <span class="hljs-number">0x64f98fa7</span>],
		[<span class="hljs-number">0x47b5481d</span>, <span class="hljs-number">0xbefa4fa4</span>]
	];</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>Initialize table of round constants
(first 64 bits of the fractional parts of the cube roots of the first 80 primes 2..311):</p></div></div><div class="code"><div class="wrapper">	k = [
		[<span class="hljs-number">0x428a2f98</span>, <span class="hljs-number">0xd728ae22</span>], [<span class="hljs-number">0x71374491</span>, <span class="hljs-number">0x23ef65cd</span>], [<span class="hljs-number">0xb5c0fbcf</span>, <span class="hljs-number">0xec4d3b2f</span>], [<span class="hljs-number">0xe9b5dba5</span>, <span class="hljs-number">0x8189dbbc</span>],
		[<span class="hljs-number">0x3956c25b</span>, <span class="hljs-number">0xf348b538</span>], [<span class="hljs-number">0x59f111f1</span>, <span class="hljs-number">0xb605d019</span>], [<span class="hljs-number">0x923f82a4</span>, <span class="hljs-number">0xaf194f9b</span>], [<span class="hljs-number">0xab1c5ed5</span>, <span class="hljs-number">0xda6d8118</span>],
		[<span class="hljs-number">0xd807aa98</span>, <span class="hljs-number">0xa3030242</span>], [<span class="hljs-number">0x12835b01</span>, <span class="hljs-number">0x45706fbe</span>], [<span class="hljs-number">0x243185be</span>, <span class="hljs-number">0x4ee4b28c</span>], [<span class="hljs-number">0x550c7dc3</span>, <span class="hljs-number">0xd5ffb4e2</span>],
		[<span class="hljs-number">0x72be5d74</span>, <span class="hljs-number">0xf27b896f</span>], [<span class="hljs-number">0x80deb1fe</span>, <span class="hljs-number">0x3b1696b1</span>], [<span class="hljs-number">0x9bdc06a7</span>, <span class="hljs-number">0x25c71235</span>], [<span class="hljs-number">0xc19bf174</span>, <span class="hljs-number">0xcf692694</span>],
		[<span class="hljs-number">0xe49b69c1</span>, <span class="hljs-number">0x9ef14ad2</span>], [<span class="hljs-number">0xefbe4786</span>, <span class="hljs-number">0x384f25e3</span>], [<span class="hljs-number">0x0fc19dc6</span>, <span class="hljs-number">0x8b8cd5b5</span>], [<span class="hljs-number">0x240ca1cc</span>, <span class="hljs-number">0x77ac9c65</span>],
		[<span class="hljs-number">0x2de92c6f</span>, <span class="hljs-number">0x592b0275</span>], [<span class="hljs-number">0x4a7484aa</span>, <span class="hljs-number">0x6ea6e483</span>], [<span class="hljs-number">0x5cb0a9dc</span>, <span class="hljs-number">0xbd41fbd4</span>], [<span class="hljs-number">0x76f988da</span>, <span class="hljs-number">0x831153b5</span>],
		[<span class="hljs-number">0x983e5152</span>, <span class="hljs-number">0xee66dfab</span>], [<span class="hljs-number">0xa831c66d</span>, <span class="hljs-number">0x2db43210</span>], [<span class="hljs-number">0xb00327c8</span>, <span class="hljs-number">0x98fb213f</span>], [<span class="hljs-number">0xbf597fc7</span>, <span class="hljs-number">0xbeef0ee4</span>],
		[<span class="hljs-number">0xc6e00bf3</span>, <span class="hljs-number">0x3da88fc2</span>], [<span class="hljs-number">0xd5a79147</span>, <span class="hljs-number">0x930aa725</span>], [<span class="hljs-number">0x06ca6351</span>, <span class="hljs-number">0xe003826f</span>], [<span class="hljs-number">0x14292967</span>, <span class="hljs-number">0x0a0e6e70</span>],
		[<span class="hljs-number">0x27b70a85</span>, <span class="hljs-number">0x46d22ffc</span>], [<span class="hljs-number">0x2e1b2138</span>, <span class="hljs-number">0x5c26c926</span>], [<span class="hljs-number">0x4d2c6dfc</span>, <span class="hljs-number">0x5ac42aed</span>], [<span class="hljs-number">0x53380d13</span>, <span class="hljs-number">0x9d95b3df</span>],
		[<span class="hljs-number">0x650a7354</span>, <span class="hljs-number">0x8baf63de</span>], [<span class="hljs-number">0x766a0abb</span>, <span class="hljs-number">0x3c77b2a8</span>], [<span class="hljs-number">0x81c2c92e</span>, <span class="hljs-number">0x47edaee6</span>], [<span class="hljs-number">0x92722c85</span>, <span class="hljs-number">0x1482353b</span>],
		[<span class="hljs-number">0xa2bfe8a1</span>, <span class="hljs-number">0x4cf10364</span>], [<span class="hljs-number">0xa81a664b</span>, <span class="hljs-number">0xbc423001</span>], [<span class="hljs-number">0xc24b8b70</span>, <span class="hljs-number">0xd0f89791</span>], [<span class="hljs-number">0xc76c51a3</span>, <span class="hljs-number">0x0654be30</span>],
		[<span class="hljs-number">0xd192e819</span>, <span class="hljs-number">0xd6ef5218</span>], [<span class="hljs-number">0xd6990624</span>, <span class="hljs-number">0x5565a910</span>], [<span class="hljs-number">0xf40e3585</span>, <span class="hljs-number">0x5771202a</span>], [<span class="hljs-number">0x106aa070</span>, <span class="hljs-number">0x32bbd1b8</span>],
		[<span class="hljs-number">0x19a4c116</span>, <span class="hljs-number">0xb8d2d0c8</span>], [<span class="hljs-number">0x1e376c08</span>, <span class="hljs-number">0x5141ab53</span>], [<span class="hljs-number">0x2748774c</span>, <span class="hljs-number">0xdf8eeb99</span>], [<span class="hljs-number">0x34b0bcb5</span>, <span class="hljs-number">0xe19b48a8</span>],
		[<span class="hljs-number">0x391c0cb3</span>, <span class="hljs-number">0xc5c95a63</span>], [<span class="hljs-number">0x4ed8aa4a</span>, <span class="hljs-number">0xe3418acb</span>], [<span class="hljs-number">0x5b9cca4f</span>, <span class="hljs-number">0x7763e373</span>], [<span class="hljs-number">0x682e6ff3</span>, <span class="hljs-number">0xd6b2b8a3</span>],
		[<span class="hljs-number">0x748f82ee</span>, <span class="hljs-number">0x5defb2fc</span>], [<span class="hljs-number">0x78a5636f</span>, <span class="hljs-number">0x43172f60</span>], [<span class="hljs-number">0x84c87814</span>, <span class="hljs-number">0xa1f0ab72</span>], [<span class="hljs-number">0x8cc70208</span>, <span class="hljs-number">0x1a6439ec</span>],
		[<span class="hljs-number">0x90befffa</span>, <span class="hljs-number">0x23631e28</span>], [<span class="hljs-number">0xa4506ceb</span>, <span class="hljs-number">0xde82bde9</span>], [<span class="hljs-number">0xbef9a3f7</span>, <span class="hljs-number">0xb2c67915</span>], [<span class="hljs-number">0xc67178f2</span>, <span class="hljs-number">0xe372532b</span>],
		[<span class="hljs-number">0xca273ece</span>, <span class="hljs-number">0xea26619c</span>], [<span class="hljs-number">0xd186b8c7</span>, <span class="hljs-number">0x21c0c207</span>], [<span class="hljs-number">0xeada7dd6</span>, <span class="hljs-number">0xcde0eb1e</span>], [<span class="hljs-number">0xf57d4f7f</span>, <span class="hljs-number">0xee6ed178</span>],
		[<span class="hljs-number">0x06f067aa</span>, <span class="hljs-number">0x72176fba</span>], [<span class="hljs-number">0x0a637dc5</span>, <span class="hljs-number">0xa2c898a6</span>], [<span class="hljs-number">0x113f9804</span>, <span class="hljs-number">0xbef90dae</span>], [<span class="hljs-number">0x1b710b35</span>, <span class="hljs-number">0x131c471b</span>],
		[<span class="hljs-number">0x28db77f5</span>, <span class="hljs-number">0x23047d84</span>], [<span class="hljs-number">0x32caab7b</span>, <span class="hljs-number">0x40c72493</span>], [<span class="hljs-number">0x3c9ebe0a</span>, <span class="hljs-number">0x15c9bebc</span>], [<span class="hljs-number">0x431d67c4</span>, <span class="hljs-number">0x9c100d4c</span>],
		[<span class="hljs-number">0x4cc5d4be</span>, <span class="hljs-number">0xcb3e42b6</span>], [<span class="hljs-number">0x597f299c</span>, <span class="hljs-number">0xfc657e2a</span>], [<span class="hljs-number">0x5fcb6fab</span>, <span class="hljs-number">0x3ad6faec</span>], [<span class="hljs-number">0x6c44198c</span>, <span class="hljs-number">0x4a475817</span>]
	];

	<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">cycle</span> <span class="hljs-params">(state, w)</span> {</span>

		<span class="hljs-keyword">var</span> j, a, b, c, d, e, f, g, h, t, s0, s1, ch, temp, maj;</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>initialize hash value for this chunk:</p></div></div><div class="code"><div class="wrapper">		a = state[<span class="hljs-number">0</span>];
		b = state[<span class="hljs-number">1</span>];
		c = state[<span class="hljs-number">2</span>];
		d = state[<span class="hljs-number">3</span>];
		e = state[<span class="hljs-number">4</span>];
		f = state[<span class="hljs-number">5</span>];
		g = state[<span class="hljs-number">6</span>];
		h = state[<span class="hljs-number">7</span>];</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>Main loop:
for j from 0 to 79</p></div></div><div class="code"><div class="wrapper">		<span class="hljs-keyword">for</span> (j = <span class="hljs-number">0</span>; j &lt; <span class="hljs-number">80</span>; ++j) {</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>S1 := (e rightrotate 14) xor (e rightrotate 18) xor (e rightrotate 41)</p></div></div><div class="code"><div class="wrapper">			s1 = xor64(xor64(rot64(e, <span class="hljs-number">14</span>), rot64(e, <span class="hljs-number">18</span>)), rot64(e, <span class="hljs-number">41</span>));</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>ch := (e and f) xor ((not e) and g)</p></div></div><div class="code"><div class="wrapper">			ch = xor64(and64(e, f), and64(not64(e), g));</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>temp := h + S1 + ch + k[j] + w[j]</p></div></div><div class="code"><div class="wrapper">			temp = add64(add64(h, s1), add64(add64(ch, k[j]), w[j]));</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>d := d + temp;</p></div></div><div class="code"><div class="wrapper">			d = add64(d, temp);</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>S0 := (a rightrotate 28) xor (a rightrotate 34) xor (a rightrotate 39)</p></div></div><div class="code"><div class="wrapper">			s0 = xor64(xor64(rot64(a, <span class="hljs-number">28</span>), rot64(a, <span class="hljs-number">34</span>)), rot64(a, <span class="hljs-number">39</span>));</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>maj := (a and (b xor c)) xor (b and c)</p></div></div><div class="code"><div class="wrapper">			maj = xor64(and64(a, xor64(b, c)), and64(b, c));</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>temp := temp + S0 + maj</p></div></div><div class="code"><div class="wrapper">			temp = add64(add64(temp, s0), maj);

			h = g;
			g = f;
			f = e;
			e = d;
			d = c;
			c = b;
			b = a;
			a = temp;
		}</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>Add this chunk&#39;s hash to result so far:</p></div></div><div class="code"><div class="wrapper">		state[<span class="hljs-number">0</span>] = add64(state[<span class="hljs-number">0</span>], a);
		state[<span class="hljs-number">1</span>] = add64(state[<span class="hljs-number">1</span>], b);
		state[<span class="hljs-number">2</span>] = add64(state[<span class="hljs-number">2</span>], c);
		state[<span class="hljs-number">3</span>] = add64(state[<span class="hljs-number">3</span>], d);
		state[<span class="hljs-number">4</span>] = add64(state[<span class="hljs-number">4</span>], e);
		state[<span class="hljs-number">5</span>] = add64(state[<span class="hljs-number">5</span>], f);
		state[<span class="hljs-number">6</span>] = add64(state[<span class="hljs-number">6</span>], g);
		state[<span class="hljs-number">7</span>] = add64(state[<span class="hljs-number">7</span>], h);
	}

	<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">call</span> <span class="hljs-params">(h, data, o)</span> {</span>

		<span class="hljs-keyword">var</span> w, j, s0, s1;

		w = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Array</span>(<span class="hljs-number">80</span>);</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>break chunk into sixteen 64-bit big-endian words w[i], 0 ≤ i ≤ 15</p></div></div><div class="code"><div class="wrapper">		<span class="hljs-keyword">for</span> (j = <span class="hljs-number">0</span>; j &lt; <span class="hljs-number">16</span>; ++j) {
			w[j] = big64(data, o + j * <span class="hljs-number">8</span>);
		}</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>Extend the sixteen 64-bit words into 80 64-bit words:
for j from 16 to 79</p></div></div><div class="code"><div class="wrapper">		<span class="hljs-keyword">for</span> (j = <span class="hljs-number">16</span>; j &lt; <span class="hljs-number">80</span>; ++j) {</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>s0 := (w[j-15] rightrotate 1) xor (w[j-15] rightrotate 8) xor (w[j-15] rightshift 7)</p></div></div><div class="code"><div class="wrapper">			s0 = xor64(xor64(rot64(w[j-<span class="hljs-number">15</span>],  <span class="hljs-number">1</span>), rot64(w[j-<span class="hljs-number">15</span>],  <span class="hljs-number">8</span>)), sh64(w[j-<span class="hljs-number">15</span>], <span class="hljs-number">7</span>));</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>s1 := (w[j-2] rightrotate 19) xor (w[j-2] rightrotate 61) xor (w[j-2] rightshift 6)</p></div></div><div class="code"><div class="wrapper">			s1 = xor64(xor64(rot64(w[j- <span class="hljs-number">2</span>], <span class="hljs-number">19</span>), rot64(w[j- <span class="hljs-number">2</span>], <span class="hljs-number">61</span>)), sh64(w[j- <span class="hljs-number">2</span>], <span class="hljs-number">6</span>));</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>w[j] := w[j-16] + s0 + w[j-7] + s1</p></div></div><div class="code"><div class="wrapper">			w[j] = add64(add64(w[j-<span class="hljs-number">16</span>], s0), add64(w[j-<span class="hljs-number">7</span>], s1));
		}


		cycle(h, w);
	}</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>PREPARE</p></div></div><div class="code"><div class="wrapper">	q = n / <span class="hljs-number">8</span> | <span class="hljs-number">0</span>;
	z = q * <span class="hljs-number">8</span>;
	u = n - z;</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>append the bit &#39;1&#39; to the message</p></div></div><div class="code"><div class="wrapper">	<span class="hljs-keyword">if</span> (u &gt; <span class="hljs-number">0</span>) {
		last = bytes[q] &amp; (~<span class="hljs-number">0</span>) &lt;&lt; (<span class="hljs-number">7</span>-u);
	}
	<span class="hljs-keyword">else</span> {
		last = <span class="hljs-number">0x80</span>;
	}</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>Process the message in successive 1024-bit chunks:
break message into 1024-bit chunks</p></div></div><div class="code"><div class="wrapper">	m = n / <span class="hljs-number">1024</span> | <span class="hljs-number">0</span>;
	y = (n - <span class="hljs-number">1024</span> * m) / <span class="hljs-number">8</span> | <span class="hljs-number">0</span>;</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>offset in data</p></div></div><div class="code"><div class="wrapper">	o = <span class="hljs-number">0</span>;</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>for each chunk</p></div></div><div class="code"><div class="wrapper">	<span class="hljs-keyword">for</span> (j = <span class="hljs-number">0</span>; j &lt; m; ++j, o += <span class="hljs-number">128</span>) {
		call(h, bytes, o);
	}</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>last bytes + padding + length</p></div></div><div class="code"><div class="wrapper">	tail = [];</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>last bytes</p></div></div><div class="code"><div class="wrapper">	<span class="hljs-keyword">for</span> (j = <span class="hljs-number">0</span>; j &lt; y; ++j) {
		tail.push(bytes[o + j]);
	}</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>special care taken for the very last byte which could
have been modified if n is not a multiple of 8</p></div></div><div class="code"><div class="wrapper">	tail.push(last);</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>append 0 ≤ k &lt; 1024 bits &#39;0&#39;, so that the resulting
message length (in bits) is congruent to 896 (mod 1024)</p></div></div><div class="code"><div class="wrapper">	g = (<span class="hljs-number">896</span> - (n + <span class="hljs-number">1</span>) % <span class="hljs-number">1024</span>);
	zeroes = g / <span class="hljs-number">8</span> | <span class="hljs-number">0</span>;

	<span class="hljs-keyword">if</span> (g &lt; <span class="hljs-number">0</span>) {</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>we need an additional block as there is
not enough space left to append
the length of the data in bits</p></div></div><div class="code"><div class="wrapper">		<span class="hljs-keyword">for</span> (j = <span class="hljs-number">0</span>; j &lt; -zeroes; ++j) {
			tail.push(<span class="hljs-number">0</span>);
		}

		call(h, tail, <span class="hljs-number">0</span>);

		zeroes = <span class="hljs-number">896</span> / <span class="hljs-number">8</span>;
		tail = [];
	}</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>pad with zeroes</p></div></div><div class="code"><div class="wrapper">	<span class="hljs-keyword">for</span> (j = <span class="hljs-number">0</span>; j &lt; zeroes; ++j) {
		tail.push(<span class="hljs-number">0</span>);
	}</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>append length of message (before preparation), in bits,
as 128-bit big-endian integer</p></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>JavaScript works with 32 bit integers.
tail.push((n &gt;&gt;&gt; 124) &amp; 0xff);
tail.push((n &gt;&gt;&gt; 116) &amp; 0xff);
tail.push((n &gt;&gt;&gt; 108) &amp; 0xff);
tail.push((n &gt;&gt;&gt; 96) &amp; 0xff);
tail.push((n &gt;&gt;&gt; 88) &amp; 0xff);
tail.push((n &gt;&gt;&gt; 80) &amp; 0xff);
tail.push((n &gt;&gt;&gt; 72) &amp; 0xff);
tail.push((n &gt;&gt;&gt; 64) &amp; 0xff);
tail.push((n &gt;&gt;&gt; 56) &amp; 0xff);
tail.push((n &gt;&gt;&gt; 48) &amp; 0xff);
tail.push((n &gt;&gt;&gt; 40) &amp; 0xff);
tail.push((n &gt;&gt;&gt; 32) &amp; 0xff);</p></div></div><div class="code"><div class="wrapper">	tail.push(<span class="hljs-number">0</span>);
	tail.push(<span class="hljs-number">0</span>);
	tail.push(<span class="hljs-number">0</span>);
	tail.push(<span class="hljs-number">0</span>);
	tail.push(<span class="hljs-number">0</span>);
	tail.push(<span class="hljs-number">0</span>);
	tail.push(<span class="hljs-number">0</span>);
	tail.push(<span class="hljs-number">0</span>);
	tail.push(<span class="hljs-number">0</span>);
	tail.push(<span class="hljs-number">0</span>);
	tail.push(<span class="hljs-number">0</span>);
	tail.push(<span class="hljs-number">0</span>);

	tail.push((n &gt;&gt;&gt; <span class="hljs-number">24</span>) &amp; <span class="hljs-number">0xff</span>);
	tail.push((n &gt;&gt;&gt; <span class="hljs-number">16</span>) &amp; <span class="hljs-number">0xff</span>);
	tail.push((n &gt;&gt;&gt;  <span class="hljs-number">8</span>) &amp; <span class="hljs-number">0xff</span>);
	tail.push((n &gt;&gt;&gt;  <span class="hljs-number">0</span>) &amp; <span class="hljs-number">0xff</span>);

	call(h, tail, <span class="hljs-number">0</span>);

	<span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>, j = <span class="hljs-number">0</span>; j &lt; <span class="hljs-number">6</span>; ++j) {
		digest[i] = (h[j][<span class="hljs-number">0</span>] &gt;&gt;&gt; <span class="hljs-number">24</span>) &amp; <span class="hljs-number">0xff</span>;
		++i;
		digest[i] = (h[j][<span class="hljs-number">0</span>] &gt;&gt;&gt; <span class="hljs-number">16</span>) &amp; <span class="hljs-number">0xff</span>;
		++i;
		digest[i] = (h[j][<span class="hljs-number">0</span>] &gt;&gt;&gt;  <span class="hljs-number">8</span>) &amp; <span class="hljs-number">0xff</span>;
		++i;
		digest[i] = (h[j][<span class="hljs-number">0</span>] &gt;&gt;&gt;  <span class="hljs-number">0</span>) &amp; <span class="hljs-number">0xff</span>;
		++i;
		digest[i] = (h[j][<span class="hljs-number">1</span>] &gt;&gt;&gt; <span class="hljs-number">24</span>) &amp; <span class="hljs-number">0xff</span>;
		++i;
		digest[i] = (h[j][<span class="hljs-number">1</span>] &gt;&gt;&gt; <span class="hljs-number">16</span>) &amp; <span class="hljs-number">0xff</span>;
		++i;
		digest[i] = (h[j][<span class="hljs-number">1</span>] &gt;&gt;&gt;  <span class="hljs-number">8</span>) &amp; <span class="hljs-number">0xff</span>;
		++i;
		digest[i] = (h[j][<span class="hljs-number">1</span>] &gt;&gt;&gt;  <span class="hljs-number">0</span>) &amp; <span class="hljs-number">0xff</span>;
		++i;
	}

	<span class="hljs-keyword">return</span> digest;
};

exports.sha384 = sha384;</div></div></div></div></body></html>