'use strict';

Object.defineProperty(exports, "__esModule", {
	value: true
});
exports.md5 = md5;

var _uint = require('../uint32');

function cycle(h, k, r, w) {

	// initialize hash value for this chunk:
	var a = h[0];
	var b = h[1];
	var c = h[2];
	var d = h[3];

	// main loop
	for (var i = 0; i < 64; ++i) {

		var f = void 0,
		    g = void 0;

		if (i < 16) {
			f = b & c | ~b & d;
			g = i;
		} else if (i < 32) {
			f = d & b | ~d & c;
			g = (5 * i + 1) % 16;
		} else if (i < 48) {
			f = b ^ c ^ d;
			g = (3 * i + 5) % 16;
		} else {
			f = c ^ (b | ~d);
			g = 7 * i % 16;
		}

		var t = d;
		d = c;
		c = b;
		b = (0, _uint.add32)(b, (0, _uint.rot32)((0, _uint.add32)((0, _uint.add32)(a, f), (0, _uint.add32)(k[i], w[g])), r[i]));
		a = t;
	}

	// Add this chunk's hash to result so far:
	h[0] = (0, _uint.add32)(h[0], a);
	h[1] = (0, _uint.add32)(h[1], b);
	h[2] = (0, _uint.add32)(h[2], c);
	h[3] = (0, _uint.add32)(h[3], d);
}

function call(h, k, r, data, o) {

	//break chunk into sixteen 32-bit little-endian words w[i], 0 ≤ i ≤ 15

	var w = [(0, _uint.lil32)(data, o + 0), (0, _uint.lil32)(data, o + 4), (0, _uint.lil32)(data, o + 8), (0, _uint.lil32)(data, o + 12), (0, _uint.lil32)(data, o + 16), (0, _uint.lil32)(data, o + 20), (0, _uint.lil32)(data, o + 24), (0, _uint.lil32)(data, o + 28), (0, _uint.lil32)(data, o + 32), (0, _uint.lil32)(data, o + 36), (0, _uint.lil32)(data, o + 40), (0, _uint.lil32)(data, o + 44), (0, _uint.lil32)(data, o + 48), (0, _uint.lil32)(data, o + 52), (0, _uint.lil32)(data, o + 56), (0, _uint.lil32)(data, o + 60)];

	cycle(h, k, r, w);
}

/**
 * MD5
 */
function md5(bytes, n, digest) {

	var k = [0xd76aa478, 0xe8c7b756, 0x242070db, 0xc1bdceee, 0xf57c0faf, 0x4787c62a, 0xa8304613, 0xfd469501, 0x698098d8, 0x8b44f7af, 0xffff5bb1, 0x895cd7be, 0x6b901122, 0xfd987193, 0xa679438e, 0x49b40821, 0xf61e2562, 0xc040b340, 0x265e5a51, 0xe9b6c7aa, 0xd62f105d, 0x02441453, 0xd8a1e681, 0xe7d3fbc8, 0x21e1cde6, 0xc33707d6, 0xf4d50d87, 0x455a14ed, 0xa9e3e905, 0xfcefa3f8, 0x676f02d9, 0x8d2a4c8a, 0xfffa3942, 0x8771f681, 0x6d9d6122, 0xfde5380c, 0xa4beea44, 0x4bdecfa9, 0xf6bb4b60, 0xbebfbc70, 0x289b7ec6, 0xeaa127fa, 0xd4ef3085, 0x04881d05, 0xd9d4d039, 0xe6db99e5, 0x1fa27cf8, 0xc4ac5665, 0xf4292244, 0x432aff97, 0xab9423a7, 0xfc93a039, 0x655b59c3, 0x8f0ccc92, 0xffeff47d, 0x85845dd1, 0x6fa87e4f, 0xfe2ce6e0, 0xa3014314, 0x4e0811a1, 0xf7537e82, 0xbd3af235, 0x2ad7d2bb, 0xeb86d391];

	var r = [7, 12, 17, 22, 7, 12, 17, 22, 7, 12, 17, 22, 7, 12, 17, 22, 5, 9, 14, 20, 5, 9, 14, 20, 5, 9, 14, 20, 5, 9, 14, 20, 4, 11, 16, 23, 4, 11, 16, 23, 4, 11, 16, 23, 4, 11, 16, 23, 6, 10, 15, 21, 6, 10, 15, 21, 6, 10, 15, 21, 6, 10, 15, 21];

	// PREPARE

	var q = n / 8 | 0;
	var z = q * 8;
	var u = n - z;

	// append the bit '1' to the message
	var last = void 0;
	if (u > 0) {
		last = bytes[q] & ~0 << 7 - u;
	} else {
		last = 0x80;
	}

	// initialize state
	var h = [0x67452301, 0xefcdab89, 0x98badcfe, 0x10325476];

	// Process the message in successive 512-bit chunks:
	// break message into 512-bit chunks

	var m = n / 512 | 0;
	var y = (n - 512 * m) / 8 | 0;

	// offset in data
	var o = 0;

	// for each chunk
	for (var j = 0; j < m; ++j, o += 64) {
		call(h, k, r, bytes, o);
	}

	// last bytes + padding + length
	var tail = [];

	// last bytes
	for (var _j = 0; _j < y; ++_j) {
		tail.push(bytes[o + _j]);
	}

	// special care taken for the very last byte which could
	// have been modified if n is not a multiple of 8
	tail.push(last);

	// append 0 ≤ k < 512 bits '0', so that the resulting
	// message length (in bits) is congruent to 448 (mod 512)
	var zeroes = (448 - (n + 1) % 512) / 8 | 0;

	if (zeroes < 0) {
		// we need an additional block as there is
		// not enough space left to append
		// the length of the data in bits

		for (var _j2 = 0; _j2 < -zeroes; ++_j2) {
			tail.push(0);
		}

		call(h, k, r, tail, 0);

		zeroes = 448 / 8;
		tail = [];
	}

	// pad with zeroes
	for (var _j3 = 0; _j3 < zeroes; ++_j3) {
		tail.push(0);
	}

	// append length of message (before preparation), in bits,
	// as 64-bit little-endian integer

	tail.push(n >>> 0 & 0xFF);
	tail.push(n >>> 8 & 0xFF);
	tail.push(n >>> 16 & 0xFF);
	tail.push(n >>> 24 & 0xFF);
	// JavaScript works with 32 bit integers.
	// tail.push((n >>> 32) & 0xFF);
	// tail.push((n >>> 40) & 0xFF);
	// tail.push((n >>> 48) & 0xFF);
	// tail.push((n >>> 56) & 0xFF);
	tail.push(0);
	tail.push(0);
	tail.push(0);
	tail.push(0);

	call(h, k, r, tail, 0);

	digest[0] = h[0] >>> 0 & 0xFF;
	digest[1] = h[0] >>> 8 & 0xFF;
	digest[2] = h[0] >>> 16 & 0xFF;
	digest[3] = h[0] >>> 24 & 0xFF;
	digest[4] = h[1] >>> 0 & 0xFF;
	digest[5] = h[1] >>> 8 & 0xFF;
	digest[6] = h[1] >>> 16 & 0xFF;
	digest[7] = h[1] >>> 24 & 0xFF;
	digest[8] = h[2] >>> 0 & 0xFF;
	digest[9] = h[2] >>> 8 & 0xFF;
	digest[10] = h[2] >>> 16 & 0xFF;
	digest[11] = h[2] >>> 24 & 0xFF;
	digest[12] = h[3] >>> 0 & 0xFF;
	digest[13] = h[3] >>> 8 & 0xFF;
	digest[14] = h[3] >>> 16 & 0xFF;
	digest[15] = h[3] >>> 24 & 0xFF;

	return digest;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9oYXNoL21kNS5qcyJdLCJuYW1lcyI6WyJtZDUiLCJjeWNsZSIsImgiLCJrIiwiciIsInciLCJhIiwiYiIsImMiLCJkIiwiaSIsImYiLCJnIiwidCIsImNhbGwiLCJkYXRhIiwibyIsImJ5dGVzIiwibiIsImRpZ2VzdCIsInEiLCJ6IiwidSIsImxhc3QiLCJtIiwieSIsImoiLCJ0YWlsIiwicHVzaCIsInplcm9lcyJdLCJtYXBwaW5ncyI6Ijs7Ozs7UUE4RWdCQSxHLEdBQUFBLEc7O0FBOUVoQjs7QUFFQSxTQUFTQyxLQUFULENBQWdCQyxDQUFoQixFQUFtQkMsQ0FBbkIsRUFBc0JDLENBQXRCLEVBQXlCQyxDQUF6QixFQUE0Qjs7QUFFM0I7QUFDQSxLQUFJQyxJQUFJSixFQUFFLENBQUYsQ0FBUjtBQUNBLEtBQUlLLElBQUlMLEVBQUUsQ0FBRixDQUFSO0FBQ0EsS0FBSU0sSUFBSU4sRUFBRSxDQUFGLENBQVI7QUFDQSxLQUFJTyxJQUFJUCxFQUFFLENBQUYsQ0FBUjs7QUFFQTtBQUNBLE1BQUssSUFBSVEsSUFBSSxDQUFiLEVBQWdCQSxJQUFJLEVBQXBCLEVBQXdCLEVBQUVBLENBQTFCLEVBQTZCOztBQUU1QixNQUFJQyxVQUFKO0FBQUEsTUFBUUMsVUFBUjs7QUFFQSxNQUFJRixJQUFJLEVBQVIsRUFBWTtBQUNYQyxPQUFLSixJQUFJQyxDQUFMLEdBQVksQ0FBRUQsQ0FBSCxHQUFRRSxDQUF2QjtBQUNBRyxPQUFJRixDQUFKO0FBQ0EsR0FIRCxNQUlLLElBQUlBLElBQUksRUFBUixFQUFZO0FBQ2hCQyxPQUFLRixJQUFJRixDQUFMLEdBQVksQ0FBRUUsQ0FBSCxHQUFRRCxDQUF2QjtBQUNBSSxPQUFJLENBQUMsSUFBSUYsQ0FBSixHQUFRLENBQVQsSUFBYyxFQUFsQjtBQUNBLEdBSEksTUFJQSxJQUFJQSxJQUFJLEVBQVIsRUFBWTtBQUNoQkMsT0FBSUosSUFBSUMsQ0FBSixHQUFRQyxDQUFaO0FBQ0FHLE9BQUksQ0FBQyxJQUFJRixD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LFFBQU8sRUFBUCxJQUFjakIsRUFBRSxDQUFGLE1BQVMsRUFBVixHQUFnQixJQUE3Qjs7QUFFQSxRQUFPaUIsTUFBUDtBQUVBIiwiZmlsZSI6Im1kNS5qcyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGFkZDMyICwgcm90MzIgLCBsaWwzMiB9IGZyb20gJy4uL3VpbnQzMicgO1xuXG5mdW5jdGlvbiBjeWNsZSAoaCwgaywgciwgdykge1xuXG5cdC8vIGluaXRpYWxpemUgaGFzaCB2YWx1ZSBmb3IgdGhpcyBjaHVuazpcblx0bGV0IGEgPSBoWzBdO1xuXHRsZXQgYiA9IGhbMV07XG5cdGxldCBjID0gaFsyXTtcblx0bGV0IGQgPSBoWzNdO1xuXG5cdC8vIG1haW4gbG9vcFxuXHRmb3IgKGxldCBpID0gMDsgaSA8IDY0OyArK2kpIHtcblxuXHRcdGxldCBmICwgZyA7XG5cblx0XHRpZiAoaSA8IDE2KSB7XG5cdFx0XHRmID0gKGIgJiBjKSB8ICgofiBiKSAmIGQpO1xuXHRcdFx0ZyA9IGk7XG5cdFx0fVxuXHRcdGVsc2UgaWYgKGkgPCAzMikge1xuXHRcdFx0ZiA9IChkICYgYikgfCAoKH4gZCkgJiBjKTtcblx0XHRcdGcgPSAoNSAqIGkgKyAxKSAlIDE2O1xuXHRcdH1cblx0XHRlbHNlIGlmIChpIDwgNDgpIHtcblx0XHRcdGYgPSBiIF4gYyBeIGQ7XG5cdFx0XHRnID0gKDMgKiBpICsgNSkgJSAxNjtcblx0XHR9XG5cdFx0ZWxzZSB7XG5cdFx0XHRmID0gYyBeIChiIHwgKH4gZCkpO1xuXHRcdFx0ZyA9ICg3ICogaSkgJSAxNjtcblx0XHR9XG5cblx0XHRjb25zdCB0ID0gZDtcblx0XHRkID0gYztcblx0XHRjID0gYjtcblx0XHRiID0gYWRkMzIoYiwgcm90MzIoYWRkMzIoYWRkMzIoYSwgZiksIGFkZDMyKGtbaV0sIHdbZ10pKSAsIHJbaV0pKTtcblx0XHRhID0gdDtcblxuXHR9XG5cblx0Ly8gQWRkIHRoaXMgY2h1bmsncyBoYXNoIHRvIHJlc3VsdCBzbyBmYXI6XG5cdGhbMF0gPSBhZGQzMihoWzBdLCBhKTtcblx0aFsxXSA9IGFkZDMyKGhbMV0sIGIpO1xuXHRoWzJdID0gYWRkMzIoaFsyXSwgYyk7XG5cdGhbM10gPSBhZGQzMihoWzNdLCBkKTtcblxufVxuXG5mdW5jdGlvbiBjYWxsIChoLCBrLCByLCBkYXRhLCBvKSB7XG5cblx0Ly9icmVhayBjaHVuayBpbnRvIHNpeHRlZW4gMzItYml0IGxpdHRsZS1lbmRpYW4gd29yZHMgd1tpXSwgMCDiiaQgaSDiiaQgMTVcblxuXHRjb25zdCB3ID0gW1xuXHRcdGxpbDMyKGRhdGEsIG8gKyAgMCksXG5cdFx0bGlsMzIoZGF0YSwgbyArICA0KSxcblx0XHRsaWwzMihkYXRhLCBvICsgIDgpLFxuXHRcdGxpbDMyKGRhdGEsIG8gKyAxMiksXG5cdFx0bGlsMzIoZGF0YSwgbyArIDE2KSxcblx0XHRsaWwzMihkYXRhLCBvICsgMjApLFxuXHRcdGxpbDMyKGRhdGEsIG8gKyAyNCksXG5cdFx0bGlsMzIoZGF0YSwgbyArIDI4KSxcblx0XHRsaWwzMihkYXRhLCBvICsgMzIpLFxuXHRcdGxpbDMyKGRhdGEsIG8gKyAzNiksXG5cdFx0bGlsMzIoZGF0YSwgbyArIDQwKSxcblx0XHRsaWwzMihkYXRhLCBvICsgNDQpLFxuXHRcdGxpbDMyKGRhdGEsIG8gKyA0OCksXG5cdFx0bGlsMzIoZGF0YSwgbyArIDUyKSxcblx0XHRsaWwzMihkYXRhLCBvICsgNTYpLFxuXHRcdGxpbDMyKGRhdGEsIG8gKyA2MClcblx0XTtcblxuXHRjeWNsZShoLCBrLCByLCB3KTtcblxufVxuXG4vKipcbiAqIE1ENVxuICovXG5leHBvcnQgZnVuY3Rpb24gbWQ1IChieXRlcywgbiwgZGlnZXN0KSB7XG5cblx0Y29uc3QgayA9IFtcblx0XHQweGQ3NmFhNDc4LCAweGU4YzdiNzU2LCAweDI0MjA3MGRiLCAweGMxYmRjZWVlICxcblx0XHQweGY1N2MwZmFmLCAweDQ3ODdjNjJhLCAweGE4MzA0NjEzLCAweGZkNDY5NTAxICxcblx0XHQweDY5ODA5OGQ4LCAweDhiNDRmN2FmLCAweGZmZmY1YmIxLCAweDg5NWNkN2JlICxcblx0XHQweDZiOTAxMTIyLCAweGZkOTg3MTkzLCAweGE2Nzk0MzhlLCAweDQ5YjQwODIxICxcblx0XHQweGY2MWUyNTYyLCAweGMwNDBiMzQwLCAweDI2NWU1YTUxLCAweGU5YjZjN2FhICxcblx0XHQweGQ2MmYxMDVkLCAweDAyNDQxNDUzLCAweGQ4YTFlNjgxLCAweGU3ZDNmYmM4ICxcblx0XHQweDIxZTFjZGU2LCAweGMzMzcwN2Q2LCAweGY0ZDUwZDg3LCAweDQ1NWExNGVkICxcblx0XHQweGE5ZTNlOTA1LCAweGZjZWZhM2Y4LCAweDY3NmYwMmQ5LCAweDhkMmE0YzhhICxcblx0XHQweGZmZmEzOTQyLCAweDg3NzFmNjgxLCAweDZkOWQ2MTIyLCAweGZkZTUzODBjICxcblx0XHQweGE0YmVlYTQ0LCAweDRiZGVjZmE5LCAweGY2YmI0YjYwLCAweGJlYmZiYzcwICxcblx0XHQweDI4OWI3ZWM2LCAweGVhYTEyN2ZhLCAweGQ0ZWYzMDg1LCAweDA0ODgxZDA1ICxcblx0XHQweGQ5ZDRkMDM5LCAweGU2ZGI5OWU1LCAweDFmYTI3Y2Y4LCAweGM0YWM1NjY1ICxcblx0XHQweGY0MjkyMjQ0LCAweDQzMmFmZjk3LCAweGFiOTQyM2E3LCAweGZjOTNhMDM5ICxcblx0XHQweDY1NWI1OWMzLCAweDhmMGNjYzkyLCAweGZmZWZmNDdkLCAweDg1ODQ1ZGQxICxcblx0XHQweDZmYTg3ZTRmLCAweGZlMmNlNmUwLCAweGEzMDE0MzE0LCAweDRlMDgxMWExICxcblx0XHQweGY3NTM3ZTgyLCAweGJkM2FmMjM1LCAweDJhZDdkMmJiLCAweGViODZkMzkxXG5cdF07XG5cblx0Y29uc3QgciA9IFtcblx0XHQ3LCAxMiwgMTcsIDIyLCA3LCAxMiwgMTcsIDIyLCA3LCAxMiwgMTcsIDIyLCA3LCAxMiwgMTcsIDIyLFxuXHRcdDUsICA5LCAxNCwgMjAsIDUsICA5LCAxNCwgMjAsIDUsICA5LCAxNCwgMjAsIDUsICA5LCAxNCwgMjAsXG5cdFx0NCwgMTEsIDE2LCAyMywgNCwgMTEsIDE2LCAyMywgNCwgMTEsIDE2LCAyMywgNCwgMTEsIDE2LCAyMyxcblx0XHQ2LCAxMCwgMTUsIDIxLCA2LCAxMCwgMTUsIDIxLCA2LCAxMCwgMTUsIDIxLCA2LCAxMCwgMTUsIDIxXG5cdF07XG5cblx0Ly8gUFJFUEFSRVxuXG5cdGNvbnN0IHEgPSBuIC8gOCB8IDA7XG5cdGNvbnN0IHogPSBxICogODtcblx0Y29uc3QgdSA9IG4gLSB6O1xuXG5cdC8vIGFwcGVuZCB0aGUgYml0ICcxJyB0byB0aGUgbWVzc2FnZVxuXHRsZXQgbGFzdCA7XG5cdGlmICh1ID4gMCkge1xuXHRcdGxhc3QgPSBieXRlc1txXSAmICh+MCkgPDwgKDctdSk7XG5cdH1cblx0ZWxzZSB7XG5cdFx0bGFzdCA9IDB4ODA7XG5cdH1cblxuXG5cblx0Ly8gaW5pdGlhbGl6ZSBzdGF0ZVxuXHRjb25zdCBoID0gWzB4Njc0NTIzMDEsIDB4ZWZjZGFiODksIDB4OThiYWRjZmUsIDB4MTAzMjU0NzZdO1xuXG5cdC8vIFByb2Nlc3MgdGhlIG1lc3NhZ2UgaW4gc3VjY2Vzc2l2ZSA1MTItYml0IGNodW5rczpcblx0Ly8gYnJlYWsgbWVzc2FnZSBpbnRvIDUxMi1iaXQgY2h1bmtzXG5cblx0Y29uc3QgbSA9IG4gLyA1MTIgfCAwO1xuXHRjb25zdCB5ID0gKG4gLSA1MTIgKiBtKSAvIDggfCAwO1xuXG5cdC8vIG9mZnNldCBpbiBkYXRhXG5cdGxldCBvID0gMDtcblxuXHQvLyBmb3IgZWFjaCBjaHVua1xuXHRmb3IgKGxldCBqID0gMDsgaiA8IG07ICsraiwgbyArPSA2NCkge1xuXHRcdGNhbGwoaCwgaywgciwgYnl0ZXMsIG8pO1xuXHR9XG5cblx0Ly8gbGFzdCBieXRlcyArIHBhZGRpbmcgKyBsZW5ndGhcblx0bGV0IHRhaWwgPSBbXTtcblxuXHQvLyBsYXN0IGJ5dGVzXG5cdGZvciAobGV0IGogPSAwOyBqIDwgeTsgKytqKSB7XG5cdFx0dGFpbC5wdXNoKGJ5dGVzW28gKyBqXSk7XG5cdH1cblxuXHQvLyBzcGVjaWFsIGNhcmUgdGFrZW4gZm9yIHRoZSB2ZXJ5IGxhc3QgYnl0ZSB3aGljaCBjb3VsZFxuXHQvLyBoYXZlIGJlZW4gbW9kaWZpZWQgaWYgbiBpcyBub3QgYSBtdWx0aXBsZSBvZiA4XG5cdHRhaWwucHVzaChsYXN0KTtcblxuXG5cdC8vIGFwcGVuZCAwIOKJpCBrIDwgNTEyIGJpdHMgJzAnLCBzbyB0aGF0IHRoZSByZXN1bHRpbmdcblx0Ly8gbWVzc2FnZSBsZW5ndGggKGluIGJpdHMpIGlzIGNvbmdydWVudCB0byA0NDggKG1vZCA1MTIpXG5cdGxldCB6ZXJvZXMgPSAoNDQ4IC0gKG4gKyAxKSAlIDUxMikgLyA4IHwgMDtcblxuXHRpZiAoemVyb2VzIDwgMCkge1xuXHRcdC8vIHdlIG5lZWQgYW4gYWRkaXRpb25hbCBibG9jayBhcyB0aGVyZSBpc1xuXHRcdC8vIG5vdCBlbm91Z2ggc3BhY2UgbGVmdCB0byBhcHBlbmRcblx0XHQvLyB0aGUgbGVuZ3RoIG9mIHRoZSBkYXRhIGluIGJpdHNcblxuXHRcdGZvciAobGV0IGogPSAwOyBqIDwgLXplcm9lczsgKytqKSB7XG5cdFx0XHR0YWlsLnB1c2goMCk7XG5cdFx0fVxuXG5cdFx0Y2FsbChoLCBrLCByLCB0YWlsLCAwKTtcblxuXHRcdHplcm9lcyA9IDQ0OCAvIDg7XG5cdFx0dGFpbCA9IFtdO1xuXHR9XG5cblxuXHQvLyBwYWQgd2l0aCB6ZXJvZXNcblx0Zm9yIChsZXQgaiA9IDA7IGogPCB6ZXJvZXM7ICsraikge1xuXHRcdHRhaWwucHVzaCgwKTtcblx0fVxuXG5cdC8vIGFwcGVuZCBsZW5ndGggb2YgbWVzc2FnZSAoYmVmb3JlIHByZXBhcmF0aW9uKSwgaW4gYml0cyxcblx0Ly8gYXMgNjQtYml0IGxpdHRsZS1lbmRpYW4gaW50ZWdlclxuXG5cdHRhaWwucHVzaCgobiA+Pj4gIDApICYgMHhGRik7XG5cdHRhaWwucHVzaCgobiA+Pj4gIDgpICYgMHhGRik7XG5cdHRhaWwucHVzaCgobiA+Pj4gMTYpICYgMHhGRik7XG5cdHRhaWwucHVzaCgobiA+Pj4gMjQpICYgMHhGRik7XG5cdC8vIEphdmFTY3JpcHQgd29ya3Mgd2l0aCAzMiBiaXQgaW50ZWdlcnMuXG5cdC8vIHRhaWwucHVzaCgobiA+Pj4gMzIpICYgMHhGRik7XG5cdC8vIHRhaWwucHVzaCgobiA+Pj4gNDApICYgMHhGRik7XG5cdC8vIHRhaWwucHVzaCgobiA+Pj4gNDgpICYgMHhGRik7XG5cdC8vIHRhaWwucHVzaCgobiA+Pj4gNTYpICYgMHhGRik7XG5cdHRhaWwucHVzaCgwKTtcblx0dGFpbC5wdXNoKDApO1xuXHR0YWlsLnB1c2goMCk7XG5cdHRhaWwucHVzaCgwKTtcblxuXHRjYWxsKGgsIGssIHIsIHRhaWwsIDApO1xuXG5cdGRpZ2VzdFswXSAgPSAoaFswXSA+Pj4gIDApICYgMHhGRjtcblx0ZGlnZXN0WzFdICA9IChoWzBdID4+PiAgOCkgJiAweEZGO1xuXHRkaWdlc3RbMl0gID0gKGhbMF0gPj4+IDE2KSAmIDB4RkY7XG5cdGRpZ2VzdFszXSAgPSAoaFswXSA+Pj4gMjQpICYgMHhGRjtcblx0ZGlnZXN0WzRdICA9IChoWzFdID4+PiAgMCkgJiAweEZGO1xuXHRkaWdlc3RbNV0gID0gKGhbMV0gPj4+ICA4KSAmIDB4RkY7XG5cdGRpZ2VzdFs2XSAgPSAoaFsxXSA+Pj4gMTYpICYgMHhGRjtcblx0ZGlnZXN0WzddICA9IChoWzFdID4+PiAyNCkgJiAweEZGO1xuXHRkaWdlc3RbOF0gID0gKGhbMl0gPj4+ICAwKSAmIDB4RkY7XG5cdGRpZ2VzdFs5XSAgPSAoaFsyXSA+Pj4gIDgpICYgMHhGRjtcblx0ZGlnZXN0WzEwXSA9IChoWzJdID4+PiAxNikgJiAweEZGO1xuXHRkaWdlc3RbMTFdID0gKGhbMl0gPj4+IDI0KSAmIDB4RkY7XG5cdGRpZ2VzdFsxMl0gPSAoaFszXSA+Pj4gIDApICYgMHhGRjtcblx0ZGlnZXN0WzEzXSA9IChoWzNdID4+PiAgOCkgJiAweEZGO1xuXHRkaWdlc3RbMTRdID0gKGhbM10gPj4+IDE2KSAmIDB4RkY7XG5cdGRpZ2VzdFsxNV0gPSAoaFszXSA+Pj4gMjQpICYgMHhGRjtcblxuXHRyZXR1cm4gZGlnZXN0O1xuXG59XG4iXX0=